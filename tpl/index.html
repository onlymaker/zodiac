<!DOCTYPE html>
<html lang="en">
<head>
<title>Onlymaker Star & Style</title>
<include href="common/header.html"/>
<style>
    .container-fluid {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: space-around;
        align-items: center;
    }
    .wrapper {
        flex-direction: column;
    }
    .img-thumbnail {
        padding-bottom: 2rem;
    }
    .icon-bar {
        display: flex;
        justify-content: space-between;
        margin-top: -2rem;
        margin-bottom: 1rem;
        padding: .25rem .5rem;
    }
    .fa {
        font-size: 1rem;
    }
    .fa-shopping-cart {
        color: #f41515;
    }
    .fa-facebook-official {
        color: #4267b2;
    }
    .fa-ban {
        color: transparent;
    }
    .btn-block {
        background-color: #f41515;
        border-radius: 0;
        color: white;
        font-family: Cabin,sans-serif;
        font-size: 0.875rem;
        font-weight: 400;
    }
</style>
</head>
<body>
<include href="common/top.html"/>
<div class="container-fluid"></div>
<script>
    let pageNo = "{{@pageNo}}";

    document.addEventListener("DOMContentLoaded", function () {
        loadGallery(pageNo);
    });

    function loadGallery(page) {
        fetch("{{@BASE}}/gallery/" + page)
            .then(function (response) {
                return response.json();
            })
            .then(function (json) {
                console.log(json);
                let html = "";
                json.subset.forEach(function (item) {
                    html += "<div class='wrapper'>" +
                        "<img alt='gallery' class='img-thumbnail' src='" + item.image + "'/>" +
                        "<div class='icon-bar'>";
                    if (item.facebook) {
                        html += "<a href='" + item.facebook + "'><i class='fa fa-facebook-official'></i></a>";
                    } else {
                        html += "<a><i class='fa fa-ban'></i></a>"
                    }
                    if (item.instagram) {
                        html += "<a href='" + item.instagram + "'><i class='fa fa-instagram'></i></a>";
                    } else {
                        html += "<a><i class='fa fa-ban'></i></a>"
                    }
                    html += "<a href='" + buildUrl(item.url) + "'><i class='fa fa-shopping-cart'></i></a></div></div>";
                });
                document.querySelector(".container-fluid").insertAdjacentHTML("beforeend", html);
                if (json.pageCount > pageNo) {
                    let next = Number(pageNo) + 1;
                    html = '<div class="btn btn-block" onclick="more(' + next + ')">Next</div>';
                } else {
                    html = '<div class="btn btn-block" onclick="shop()">Continue to Online Store</div>';
                }
                document.querySelector("body").insertAdjacentHTML("beforeend", html);
            });
    }

    function buildUrl(url) {
        return url + ((url.indexOf("?") === -1) ? "?" : "&") + "utm_source=gallery&utm_medium=gallery&utm_campaign=gallery";
    }

    function more(next) {
        //document.querySelector(".container-fluid").innerHTML = "";
        //document.querySelector(".btn-block").remove();
        //loadGallery(next);
        location.href = "{{@BASE}}?pageNo=" + next;
    }

    function shop() {
        location.href = "https://www.onlymaker.com";
    }
</script>
</body>
</html>
